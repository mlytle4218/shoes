/*! Mon Oct 15 2018 17:49:06 */

var container,controls,model,fileName,fileExt,path,camera,scene,renderer,light,light3,raycaster,mouse,plane,print,floatAnimation,initialCameraPosition,rotationDone=!1,keepAnimating=!0,floatProgress=0,skyColor=16777215,connectingElement="product-canvas",cameraDistance=50,floatRadius=10,floatSpeed=.015625,floatDistance=1,returnWaitTime=60,printScale=1,modelLoaded=!1;function loadModelOntoPage(e){init(e.gltf,e.shadow)}function init(e,t){window.addEventListener("resize",onWindowResize,!1),window.addEventListener("mousedown",onMouseDown,!1),window.addEventListener("mouseup",onMouseUp,!1),container=document.getElementById(connectingElement),(camera=new THREE.PerspectiveCamera(45,container.clientWidth/container.clientHeight,1,100)).position.set(0,0,cameraDistance),scene=new THREE.Scene;var n=new THREE.Color(16777215);scene.background=n;var o=new THREE.AmbientLight(13421772,.4);scene.add(o);var i=new THREE.DirectionalLight(14540253,1);i.position.set(1,1,0).normalize(),camera.add(i),scene.add(camera);var a=new THREE.BoxGeometry(33,3,3),r=new THREE.MeshBasicMaterial({color:16711680});cube=new THREE.Mesh(a,r),cube.scale.x=1e-4;var c=new THREE.MeshBasicMaterial({color:13421772});cube2=new THREE.Mesh(a,c),cube2.position.z=-1,scene.add(cube2),scene.add(cube),(new THREE.GLTFLoader).load(e,function(e){(model=e.scene).rotation.y=-Math.PI/2;model.scale.set(.25,.25,.25),scene.add(model),scene.add(print),modelLoaded=!0,scene.remove(cube),scene.remove(cube2),(floatAnimation=new Float(floatSpeed,model,print,floatDistance,camera,controls)).startRotate(),floatAnimation.startFloat()},function(e){pro=e.loaded/e.total,cube.scale.x=pro,cube.position.x=-(1-cube.scale.x)*(cube.geometry.parameters.width/2)},function(e){console.error(e)});var s=new THREE.TextureLoader;(r=new THREE.MeshLambertMaterial({map:s.load(t)})).transparent=!0;a=new THREE.PlaneGeometry(10,20);(print=new THREE.Mesh(a,r)).position.set(0,-10,0),print.scale.set(printScale,printScale,printScale),print.rotation.x=Math.PI/2*3,print.rotation.z=Math.PI/2,raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,(controls=new THREE.OrbitControls(camera,document.getElementById(connectingElement))).target.set(0,5,0),controls.maxDistance=cameraDistance,controls.minDistance=10,controls.update(),this.renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(container.clientWidth,container.clientHeight),renderer.gammaOutput=!0,container.appendChild(renderer.domElement),animate()}function onWindowResize(){camera.aspect=container.clientWidth/container.clientHeight,camera.updateProjectionMatrix(),renderer.setSize(container.clientWidth,container.clientHeight)}function animate(){requestAnimationFrame(animate),modelLoaded&&floatAnimation.tick(),renderer.render(scene,camera)}function onMouseDown(e){inContainer(e)&&(floatAnimation.stopFloat(),floatAnimation.isRotating()||(floatAnimation.stopFloat(),keepAnimating=!1,model.position.x=0,model.position.y=0,model.position.z=0,scene.remove(print)))}function onMouseUp(e){floatAnimation.startCounting()}function rotateOnce(e){rotationDone=!1;var t=setInterval(function(){125<=n?(clearInterval(t),rotationDone=!0):(n++,e.rotation.y+=.05,print.rotation.z+=.05)},10),n=0}function Float(e,t,n,o,i,a){var r=e,c=o,s=-1,l=c,d=1,u=!1,m=!1,f=0,p=t,h=n,E={},g=n.scale.x,w=n.scale.y;isCounting=-1;var R=1;E.position=i.position.clone(),E.rotation=i.rotation.clone(),E.center=a.center.clone(),this.tick=function(){m?this.rotate():u&!m&&this.float(),isCounting>returnWaitTime?this.returnToZero():0<=isCounting&&isCounting++},this.reOrient=function(){},this.startRotate=function(){m=!0},this.rotate=function(){125<=f?m=!1:(f++,p.rotation.y+=.05,h.rotation.z+=.05)},this.isRotating=function(){return m},this.startFloat=function(){u=!0,scene.add(n)},this.stopFloat=function(){u=!1,scene.remove(h)},this.float=function(){c<=l?(l=c,s=-s):l<=-1&&(l=-1,s=-s,R=-R),0===this.calcFloat(l)&&(d=-d),t.position.y=d*this.calcFloat(l),n.scale.x=g+.2*this.calcFloat(l)*s,n.scale.y=w+.2*this.calcFloat(l)*s,l+=r*s},this.float2=function(){console.log(this.calcFloat(l)),t.position.y=this.calcFloat(l),l+=r*s},this.returnToZero=function(){console.log("returnToZero")},this.startReturnToZero=function(){!0},this.calcFloat=function(e){return 1-Math.pow(e,2)},this.startCounting=function(){isCounting=0},this.stopCounting=function(){isCounting=-1}}function inContainer(e){return!!(e.clientX>container.offsetLeft&e.clientX<container.offsetLeft+container.clientWidth&&e.clientY>container.offsetTop&e.clientY<container.offsetTop+container.clientHeight)}